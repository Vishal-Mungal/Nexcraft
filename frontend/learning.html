<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nexcraft | Learning Paths</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #0f0f10, #11131a);
      color: #f2f2f2;
      margin: 0;
      padding: 0;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 30px;
      background-color: #0C0404;
      border-bottom: 1px solid #333;
    }
    header h1 {
      font-size: 26px;
      color: #00ffe7;
      margin: 0;
    }
    header img {
      height: 100px;
    }
    .home-button {
      padding: 8px 18px;
      background-color: #00ffe7;
      color: #11131a;
      text-decoration: none;
      border-radius: 6px;
      font-weight: 500;
    }
    .home-button:hover {
      background-color: #00b3ff;
      color: #fff;
    }
    .container {
      padding: 40px 30px;
    }
    .search-container {
      margin-top: 20px;
      display: flex;
      justify-content: center;
    }
    .search-bar {
      width: 60%;
      padding: 12px 16px;
      font-size: 16px;
      border-radius: 10px;
      border: 1px solid #444;
      background-color: #1a1a1d;
      color: white;
      outline: none;
      transition: all 0.3s ease;
    }
    .search-bar::placeholder {
      color: #999;
    }
    .search-bar:focus {
      border-color: #00ffe7;
      box-shadow: 0 0 8px rgba(0, 255, 231, 0.4);
    }
    .search-btn, .reset-btn {
      background-color: #00ffe7;
      color: #11131a;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    .search-btn:hover, .reset-btn:hover {
      background-color: #00b3ff;
      color: #fff;
      box-shadow: 0 0 8px rgba(0, 255, 231, 0.5);
    }
    .card {
      background-color: #1a1a1d;
      border: none;
      border-radius: 20px;
      padding: 24px;
      color: #f2f2f2;
      box-shadow: 0 4px 16px rgba(0,0,0,0.5);
      transition: transform 0.3s ease;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .card:hover {
      transform: translateY(-5px);
    }
    .card-title {
      color: #00ffe7;
      font-size: 20px;
      margin-bottom: 12px;
    }
    .topic-desc {
      font-size: 14px;
      color: #ccc;
      margin: 10px 0 20px;
      flex-grow: 1;
    }
    .study-button {
      padding: 8px 16px;
      background-color: #00ffe7;
      color: #11131a;
      border: none;
      border-radius: 6px;
      font-weight: 500;
      text-decoration: none;
    }
    .study-button:hover {
      background-color: #00b3ff;
      color: #fff;
    }
  </style>
</head>

<body>

<header>
  <div class="d-flex align-items-center">
    <img src="./assets/learn_logo.png" alt="Nexcraft Logo" height="60">
  </div>
  <a href="dashboard.html" class="home-button">‚Üê Dashboard</a>
</header>

<div class="search-container">
  <input type="text" id="searchInput" class="search-bar" placeholder="Search learning paths...">
  <button id="searchButton" class="btn ms-3 search-btn">Search</button>
  <button id="resetButton" class="btn ms-2 reset-btn">Reset</button>
</div>

<div class="container">
  <div class="row g-4">

    <div class="col-lg-4 col-md-6 d-flex">
      <div class="card w-100">
        <h5 class="card-title">Data Structures</h5>
        <p class="topic-desc">Master arrays, linked lists, stacks, queues, and more with practical exercises.</p>
        <button class="study-button" onclick="trackStudy('Data Structures', './learning/dsa.html')">Study</button>
      </div>
    </div>

    <div class="col-lg-4 col-md-6 d-flex">
      <div class="card w-100">
        <h5 class="card-title">Frontend Development</h5>
        <p class="topic-desc">Build interactive web pages using HTML, CSS, JavaScript, and frameworks.</p>
        <button class="study-button" onclick="trackStudy('Frontend Development', './learning/frontend.html')">Study</button>
      </div>
    </div>

    <div class="col-lg-4 col-md-6 d-flex">
      <div class="card w-100">
        <h5 class="card-title">Backend Development</h5>
        <p class="topic-desc">Create robust APIs and applications with Python, Node.js, and databases.</p>
        <button class="study-button" onclick="trackStudy('Backend Development', './learning/backend.html')">Study</button>
      </div>
    </div>

    <div class="col-lg-4 col-md-6 d-flex">
      <div class="card w-100">
        <h5 class="card-title">Database Management</h5>
        <p class="topic-desc">Understand SQL, NoSQL, and data modeling for dynamic applications.</p>
        <button class="study-button" onclick="trackStudy('Database Management', 'dbms.html')">Study</button>
      </div>
    </div>

    <div class="col-lg-4 col-md-6 d-flex">
      <div class="card w-100">
        <h5 class="card-title">Operating Systems</h5>
        <p class="topic-desc">Explore processes, memory management, file systems, and system calls.</p>
        <button class="study-button" onclick="trackStudy('Operating Systems', 'os.html')">Study</button>
      </div>
    </div>

    <div class="col-lg-4 col-md-6 d-flex">
      <div class="card w-100">
        <h5 class="card-title">Cloud Computing</h5>
        <p class="topic-desc">Learn about cloud platforms, services, and building scalable applications.</p>
        <button class="study-button" onclick="trackStudy('Cloud Computing', 'cloud.html')">Study</button>
      </div>
    </div>

  </div>
  <div id="noResults" style="display:none; text-align:center; margin-top:30px; font-size:18px; color:#ccc;">
    No results found.
  </div>
</div>

<!-- üîç Search Script -->
<script>
  window.onload = function() {
    const searchInput = document.getElementById('searchInput');
    const searchButton = document.getElementById('searchButton');
    const resetButton = document.getElementById('resetButton');
    const cardContainers = document.querySelectorAll('.container .col-lg-4');

    function performSearch() {
      const searchText = searchInput.value.toLowerCase();
      let anyVisible = false;

      cardContainers.forEach(container => {
        const title = container.querySelector('.card-title').textContent.toLowerCase();
        if (title.includes(searchText)) {
          container.style.display = 'flex';
          anyVisible = true;
        } else {
          container.style.display = 'none';
        }
      });

      document.getElementById('noResults').style.display = anyVisible ? 'none' : 'block';
    }

    function resetSearch() {
      searchInput.value = '';
      cardContainers.forEach(container => container.style.display = 'flex');
      document.getElementById('noResults').style.display = 'none';
    }

    searchButton.addEventListener('click', performSearch);
    searchInput.addEventListener('keydown', function(e) {
      if (e.key === 'Enter') performSearch();
    });
    resetButton.addEventListener('click', resetSearch);
  };
</script>

<!-- üì§ Study Progress Tracking -->
<script>
  function trackStudy(topic, link) {
    const user = JSON.parse(localStorage.getItem("user"));
    if (!user) {
      // If not logged in, just open the page without tracking
      window.location.href = link;
      return;
    }

    fetch("http://127.0.0.1:8000/api/learning/progress/", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        user_id: user.id,
        topic: topic
      })
    })
    .then(res => res.json())
    .then(data => {
      window.location.href = link;
    })
    .catch(err => {
      console.error("Progress tracking error:", err);
      window.location.href = link;
    });
  }
</script>

</body>
</html>
